(function(){function c(e){return function(t,n,r){return e.prototype[n].apply(t,r)}}function d(e,t,r,i){for(var s in t)if(t.hasOwnProperty(s)){var o=t[s];if(e.hasObservable(s)){if(!(!i.length||n.indexOf(i,s)<0))throw"Recursive setter: "+i.join(" > ");o=e.obs[s].set(o),o&&u(o)&&(r=d(e,o,r,i.slice().concat([s])))}else r[s]=o}return r}function y(e,t,r){if(!e)return;o(e)&&(e=e());if(f(e)){var i=r?r+"_":"",c=n.extend({},e.attributes,e.obs||{});t["$"+(r||"model")]=function(){return m&&m.push([e,"change"]),e},n.each(c,function(n,r){t[i+r]=function(t){return m&&m.push([e,"change:"+r]),s(t)?e.get(r):u(t)&&!a(t)?e.set(t):e.set(r,t)}})}else l(e)&&(t["$"+(r||"collection")]=function(){return m&&m.push([e,"reset add remove sort"]),e});return e}function b(e){return o(e)?e():(u(e)&&(e=a(e)?e.slice():n.clone(e),n.each(e,function(t,n){e[n]=b(t)})),e)}var e=this,t=e.Backbone,n=e._,r=t.Epoxy={},i=Array.prototype,s=n.isUndefined,o=n.isFunction,u=n.isObject,a=n.isArray,f=function(e){return e instanceof t.Model},l=function(e){return e instanceof t.Collection},h,p=c(t.Model);r.Model=t.Model.extend({constructor:function(){this.obs={},p(this,"constructor",arguments),this._init=!0,this.observableDefaults&&n.each(this.observableDefaults,function(e,t){this.addObservable(t,o(e)?e():e)},this),this.computeds&&n.each(this.computeds,function(e,t){this.addComputed(t,e)},this),n.each(this.obs,function(e,t){e.init()}),delete this._init},get:function(e){return h&&h.push([e,this]),this.hasObservable(e)?this.obs[e].get():p(this,"get",arguments)},getCopy:function(e){var t=this.get(e);return a(t)?t.slice():u(t)?n.clone(t):t},set:function(e,t,n){var r=e;return r&&!u(r)?(r={},r[e]=t):n=t,n=n||{},n.unset||(r=d(this,r,{},[])),p(this,"set",[r,n])},destroy:function(){return this.clearObservables(),p(this,"destroy",arguments)},addObservable:function(e,t){this.removeObservable(e),this.obs[e]=new v(this,e,{value:t})},addComputed:function(e,t,n){this.removeObservable(e);var r=t;if(o(t)){var s=2;r={},r._get=t,o(n)&&(r._set=n,s++),r.deps=i.slice.call(arguments,s)}this.obs[e]=new v(this,e,r)},hasObservable:function(e){return this.obs.hasOwnProperty(e)},removeObservable:function(e){this.hasObservable(e)&&(this.obs[e].dispose(),delete this.obs[e])},clearObservables:function(){for(var e in this.obs)this.removeObservable(e)},modifyArray:function(e,t){var n=this.get(e);if(a(n)&&o(i[t])){var r=i.slice.call(arguments,2),s=i[t].apply(n,r);return this.trigger("change change:"+e),s}return null},modifyObject:function(e,t,n){var r=this.get(e),i=!1;return u(r)?(s(n)&&r.hasOwnProperty(t)?(delete r[t],i=!0):r[t]!==n&&(r[t]=n,i=!0),i&&this.trigger("change change:"+e),r):null}});var v=function(e,t,r){r=r||{},r.get&&o(r.get)&&(r._get=r.get),r.set&&o(r.set)&&(r._set=r.set),delete r.get,delete r.set,n.extend(this,r),this.model=e,this.name=t,this.deps=this.deps||[],e._init||this.init()};n.extend(v.prototype,t.Events,{init:function(){h=this.deps,this.get(!0),h=null;if(this.deps.length){var e={};n.each(this.deps,function(t){var r=this.model;a(t)&&(r=t[1],t=t[0]),!t.indexOf("change:")||(t="change:"+t),e.hasOwnProperty(t)?n.contains(e[t],r)||e[t].push(r):e[t]=[r]},this),n.each(e,function(e,t){for(var r=0,i=e.length;r<i;r++)this.listenTo(e[r],t,n.bind(this.get,this,!0))},this)}},get:function(e){if(e===!0&&this._get){var t=this._get.call(this.model);this.change(t)}return this.value},set:function(e){if(this._get){if(this._set)return this._set.apply(this.model,arguments);throw"Cannot set read-only computed observable."}return this.change(e),null},fire:function(){this.model.trigger("change change:"+this.name)},change:function(e){n.isEqual(e,this.value)||(this.value=e,this.fire())},dispose:function(){this.stopListening(),this.off(),this.model=this.value=null}});var m,g=c(t.View);r.View=t.View.extend({constructor:function(e){this._bind=[],g(this,"constructor",arguments),this.applyBindings()},bindings:"data-bind",applyBindings:function(){function s(t,n,s){try{e._bind.push(new S(t,n,i,r))}catch(o){throw'Error parsing bindings for "'+s+'" >> '+o}}this.removeBindings();if(!this.model&&!this.collection)return;var e=this,t=this.bindingSources,r=n.clone(w),i={};n.each(e.bindingHandlers||{},function(e,t){r[t]=o(e)?{set:e}:e}),e.model=y(e.model,i),e.collection=y(e.collection,i),n.each(t,function(e,n){t[n]=y(e,i,n)});if(u(this.bindings))n.each(this.bindings,function(e,t){var n=this.$(t);this.$el.is(t)&&(n=n.add(this.$el)),n.length&&s(n,e,t)},this);else{var a=this.bindings,f="["+a+"]",l=this.$(f);this.$el.is(f)&&(l=l.add(this.$el)),l.each(function(e){e=$(this),s(e,e.attr(a),f)})}},removeBindings:function(){while(this._bind.length)this._bind.pop().dispose()},remove:function(){this.removeBindings(),g(this,"remove")}});var w={attr:{set:function(e,t){e.attr(t)}},checked:{get:function(e,t){var r=!!e.prop("checked"),i=e.val();if(e.is(":radio"))return i;if(a(t)){t=t.slice();var s=n.indexOf(t,i);return r&&s<0?t.push(i):!r&&s>-1&&t.splice(s,1),t}return r},set:function(e,t){var r=!!t;e.is(":radio")?r=t==e.val():a(t)&&(r=n.contains(t,e.val())),e.prop("checked",r)}},classes:{set:function(e,t){n.each(t,function(t,n){e.toggleClass(n,!!t)})}},collection:{set:function(e,t,r){if(!l(t)||!o(t.view))throw"Binding 'collection:' requires a Collection with a 'view' constructor.";var i=t.models,s=this.v,u;r=r||t;if(f(r))if(!s.hasOwnProperty(r.cid)){s[r.cid]=u=new t.view({model:r});var a=n.indexOf(i,r);e.children().length<a?e.eq(a).before(u.$el):e.append(u.$el)}else u=s[r.cid],u.remove(),delete s[r.cid];else if(l(r)){var c=i.length&&n.every(i,function(e){return s.hasOwnProperty(e.cid)});e.hide(),c?t.each(function(t){e.append(s[t.cid].$el)}):(this.empty(),t.each(function(n){s[n.cid]=u=new t.view({model:n}),e.append(u.$el)})),e.show()}}},css:{set:function(e,t){e.css(t)}},disabled:{set:function(e,t){e.prop("disabled",!!t)}},enabled:{set:function(e,t){e.prop("disabled",!t)}},html:{set:function(e,t){e.html(t)}},text:{set:function(e,t){e.text(t)}},toggle:{set:function(e,t){e.toggle(!!t)}},value:{get:function(e){return e.val()},set:function(e,t){e.val()!=t&&e.val(t)}}},E={all:function(){var e=arguments;return function(){var t=!0;for(var n=0,r=e.length;n<r;n++)b(e[n])||(t=!1);return t}},any:function(){var e=arguments;return function(){var t=!1;for(var n=0,r=e.length;n<r;n++)b(e[n])&&(t=!0);return t}},length:function(e){return function(){return b(e).length||0}},none:function(){var e=arguments;return function(){var t=!0;for(var n=0,r=e.length;n<r;n++)b(e[n])&&(t=!1);return t}},not:function(e){return function(){return!b(e)}},format:function(){var e=arguments;return function(){var t=b(e[0]);for(var n=1,r=e.length;n<r;n++)t=t.replace("$"+n,b(e[n]));return t}},select:function(){var e=arguments;return function(){var t=b(e[0]),n=b(e[1]),r=b(e[2]);return t?n:r}}},S=function(e,t,r,i){this.$el=e,this.v={};var s=this,u=e[0].tagName.toLowerCase(),f=u=="input"||u=="select"||u=="textarea",l=new Function("$o","$a","with($o){with($a){return{"+t+"}}}"),c=["change"];t=l(E,r),t.events&&(c=a(t.events)?n.union(c,t.events):c,delete t.events),this.events=n.map(c,function(e){return e+".epoxy"}).join(" "),n.each(t,function(e,t){if(!i.hasOwnProperty(t))throw"invalid binding => "+t;var n=i[t],r=[];m=r,n.set.call(s,s.$el,b(e)),m=null,f&&n.get&&o(e)&&s.$el.on(s.events,function(){e(n.get.call(s,s.$el,b(e)))});if(r.length){var u=function(t){n.set.call(s,s.$el,b(e),t)};for(var a=0,l=r.length;a<l;a++)s.listenTo(r[a][0],r[a][1],u)}})};n.extend(S.prototype,t.Events,{empty:function(){for(var e in this.v)this.v.hasOwnProperty(e)&&(this.v[e].remove(),delete this.v[e])},dispose:function(){this.empty(),this.stopListening(),this.$el.off(this.events),this.$el=null}})}).call(this);