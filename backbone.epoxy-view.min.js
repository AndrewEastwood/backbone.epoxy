(function(e,t){function r(e){return t.isFunction(e)?e():(t.isObject(e)&&(e=t.isArray(e)?e.slice():t.clone(e),t.each(e,function(t,n){e[n]=r(t)})),e)}e.Epoxy={};var n=e.Epoxy.View=e.View.extend({constructor:function(t){this._bind=[],e.View.prototype.constructor.call(this,arguments),this.applyBindings()},applyBindings:function(){function a(e,t,n){try{u._bind.push(new s(e,t,i,r,o))}catch(a){throw'Error parsing bindings for "'+n+'" >> '+a}}this.removeBindings();if(!this.model||!this.bindings)return;var r=t.extend({},e.Epoxy.defaultBindings,this.operators||{}),i={},o=this.model,u=this;t.each(t.extend({},o.attributes,o.obs||{}),function(e,r){i[r]=function(e){return n._map&&n._map.push("change:"+r),t.isUndefined(e)?o.get(r):e&&t.isObject(e)&&!t.isArray(e)?o.set(e):o.set(r,e)}});if(this.bindings&&typeof this.bindings=="object")t.each(this.bindings,function(e,t){var n=this.$(t);this.$el.is(t)&&(n=n.add(this.$el)),n.length&&a(n,e,t)},this);else{var f=this.bindings,l="["+f+"]",c=this.$(l);this.$el.is(l)&&(c=c.add(this.$el)),c.each(function(e){e=$(this),a(e,e.attr(f),l)})}},removeBindings:function(){while(this._bind.length)this._bind.pop().dispose()},remove:function(){this.removeBindings(),e.View.prototype.remove.call(this)}});e.Epoxy.defaultBindings={attr:{set:function(e,t){e.attr(t)}},checked:{get:function(e,n){var r=!!e.prop("checked"),i=e.val();if(e.is(":radio"))return i;if(t.isArray(n)){var s=t.indexOf(n,i);return r&&s<0?n.push(i):!r&&s>-1&&n.splice(s,1),n}return r},set:function(e,n){var r=!!n;e.is(":radio")?r=n==e.val():t.isArray(n)&&(r=t.contains(n,e.val())),e.prop("checked",r)}},className:{set:function(e,n){t.each(n,function(t,n){e.toggleClass(n,!!t)})}},collection:{set:function(n,r){if(!(r instanceof e.Collection&&t.isFunction(r.view)))throw"Binding 'collection:' requires a Backbone.Collection with a '.view' property.";var i=$("<div/>");n.empty(),r.each(function(e,t){e.view||(e.view=new r.view({model:e})),i.append(e.view.$el)}),n.append(i.children())}},css:{set:function(e,t){e.css(t)}},disabled:{set:function(e,t){e.prop("disabled",!!t)}},enabled:{set:function(e,t){e.prop("disabled",!t)}},html:{set:function(e,t){e.html(t)}},text:{set:function(e,t){e.text(t)}},toggle:{set:function(e,t){e.toggle(!!t)}},value:{get:function(e){return e.val()},set:function(e,t){e.val(t)}}};var i={all:function(){var e=arguments;return function(){var t=!0;for(var n=0,i=e.length;n<i;n++)r(e[n])||(t=!1);return t}},any:function(){var e=arguments;return function(){var t=!1;for(var n=0,i=e.length;n<i;n++)r(e[n])&&(t=!0);return t}},none:function(){var e=arguments;return function(){var t=!0;for(var n=0,i=e.length;n<i;n++)r(e[n])&&(t=!1);return t}},not:function(e){return function(){return!r(e)}},parse:function(){var e=arguments;return function(){var t=e[0];for(var n=1,i=e.length;n<i;n++)t=t.replace("$"+n,r(e[n]));return t}}},s=function(e,s,o,u,a){this.$el=e;var f=this,l=e[0].tagName.toLowerCase(),c=l=="input"||l=="select"||l=="textarea",h=new Function("$f","$a","with($f){with($a){return{"+s+"}}}"),p=["change"];s=h(i,o),s.events&&(p=t.isArray(s.events)?t.union(p,s.events):p,delete s.events),this.events=t.map(p,function(e){return e+".epoxy"}).join(" "),t.each(s,function(e,i){if(!u.hasOwnProperty(i))throw"invalid binding => "+s;var s=u[i],o=[];n._map=o,s.set.call(f,f.$el,r(e)),n._map=null,c&&s.get&&t.isFunction(e)&&f.$el.on(f.events,function(){e(s.get.call(f,f.$el,r(e)))}),o.length&&f.listenTo(a,o.join(" "),function(){s.set.call(f,f.$el,r(e))})})};t.extend(s.prototype,e.Events,{events:"",dispose:function(){this.stopListening(),this.$el.off(this.events),this.$el=null}})})(Backbone,_);